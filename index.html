<html>
<head>
    <title>Image Database</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css"> 
	
	<script type="text/javascript">
		function codeAddress() {
			var e = document.getElementById("disp_image");
			var e_class = document.getElementById("img_class");
			var num = Math.floor(Math.random() * 33) + 1; // 0...6
			e.src = 'images/' + num + '.jpg';
			e_class.value = num;
		}
	</script>
    <script src="js/jquery.js"></script>
</head>

<body align="center" class = "w3-light-gray" onload="codeAddress();">
	
	<div class="w3-container w3-teal">
		<!-- <button class="w3-button w3-teal w3-xlarge" onclick="w3_open()">&#9776;</button> -->
		<h1 align="center" >
			Image Uploading
		</h1>
	</div>
	<div class="w3-container">
		<h2 align="center" >
			Below is the sample model Image for required pose.
		</h2>
	</div>
	<img id="disp_image" src="images/1.jpg" height="480" width="640" class="w3-border w3-border-black w3-hover-border-red w3-round w3-margin"></img><br>
	<div id="targetLayer">Upload images</div>
	<div align="center">
		<div class="w3-container w3-blue" style="width:50%">
		  <h2>Input Form</h2>
		</div>
		<form id="input_form" class="w3-container w3-border w3-border-black w3-round" method="post" style="width:50%">
			<label>Click on Choose File to capture from camera/upload from gallery</label>
			<div id="data"></div><br>
			<input name="file" id="uploadfile" type="file">
			<input id="img_class" type="hidden" name="imageClass" value="">

			<p><label>Param 1</label>
			<input class="w3-input" type="text">
			<label>Param 2</label>
			<input class="w3-input" type="text"></p>
			
			<p><button onclick="codeAddress();">Try next pose</button>
			<input id="submit" type="submit"></p>
		</form>
	<script type="text/javascript">
		$(document).ready(function (e) {
			$("[id^=input_form]").on('submit',(function(e) {
				e.preventDefault();
				$.ajax({
					url: "https://script.google.com/macros/s/AKfycbxYwVh0L_jaHud6TOzzwCd6rAZ8_aJuaZc1iIy-mwszaoVJr24/exec",
					type: "POST",
					data:  new FormData(this),
					contentType: false,
							cache: false,
					processData:false,
					timeout:240000,
					beforeSend: function()
					{
						$("#targetLayer").html("Uploading");	
					},
					success: function(data)
						{

						$("#targetLayer").html(data);
						codeAddress();
						},
					error: function() 
						{
						$("#targetLayer").html("ERROR");
						}	        
				});
			}));
		});
	</script>
	<script>
    $('#uploadfile').on("change", function() {
        var file = this.files[0];
        var fr = new FileReader();
        fr.fileName = file.name
        fr.onload = function(e) {
            e.target.result
            html = '<input type="hidden" name="data" value="' + e.target.result.replace(/^.*,/, '') + '" >';
            html += '<input type="hidden" name="mimetype" value="' + e.target.result.match(/^.*(?=;)/)[0] + '" >';
            html += '<input type="hidden" name="filename" value="' + e.target.fileName + '" >';
            $("#data").empty().append(html);
        }
        fr.readAsDataURL(file);
    });
    </script>
	</div>
</body>

</html>
